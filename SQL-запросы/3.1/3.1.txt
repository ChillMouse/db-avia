/* 3.1. Сформировать запросы, которые бы позволили просмотреть «горящие» туры (горящий тур – это выкупленный туроператором тур, который  в приближающиеся даты вылета рискует быть не проданным. Для того, чтобы возместить свои затраты на тур, туроператор снижает его стоимость.)*/

SELECT Tours.id, cityOutput, countryInput, dateOutput, priceTotal, CONVERT (int, priceTotal * 0.4) AS hotPrice /*Выводим только нужные столбцы, и создаём новый - это горячая цена на тур. Скидка 60%*/
FROM Tours INNER JOIN Prices ON (Tours.id = Prices.id_tour) /* Делаем соединение двух таблиц, строки составляем друг другу по id  и id_tour*/
WHERE DATEDIFF(DAY,SYSDATETIME(), Tours.dateOutput) <= 2  /* Условие, вибираем только те строки, где разница между датами меньше, чем 2 суток  */
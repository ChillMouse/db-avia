/*3.5 Реализовать подсчет общей суммы тура с учетом скидки клиента.*/

SELECT *, Clients.id, Sales.id_client, CONVERT(float, Sales.sale) / 100 AS Sale, (1 - CONVERT(float, Sales.sale) / 100) * Prices.priceTotal AS [Price and personal sale] /*Выбираю и считаю те данные, которые мне необходимы. В частности - новую цену на тур конкретно для пользователя*/
FROM  /*Извлекаю из таблицы, которая собрана "на лету" из слияния таблиц с клиентами, их скидками и с турами, ценами на них*/
(
(
Clients 
INNER JOIN /* соединение таблицы клиентов и их скидок по идентификатору клиента и внешнему ключу клиента в таблице скидок */
Sales 
ON Clients.id = Sales.id_client /* это условие, по которому происходит соотнесение строк из таблиц */
)
CROSS JOIN /* соединение таблиц без каких-либо условий */
(
Tours
INNER JOIN /* Слияние таблицы туров и цен на эти туры, соотнесение по идентификатору тура и внешнему ключу тура в таблице цен */
Prices
ON Tours.id = Prices.id_tour /* это условие, по которому происходит соотнесение строк из таблиц */
)
)
ORDER BY Clients.id ASC /* Сортировка по алфавиту (по порядку) по id клиента */